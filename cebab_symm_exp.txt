/bin/bash: /anaconda/envs/tf/lib/libtinfo.so.6: no version information available (required by /bin/bash)
mkdir: cannot create directory ‘logs’: File exists
2023-03-10 07:13:28.467150: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:13:28.631632: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-03-10 07:13:29.178579: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:13:29.178692: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:13:29.178712: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
/anaconda/envs/tf/lib/python3.9/site-packages/gensim/similarities/__init__.py:15: UserWarning: The gensim.similarities.levenshtein submodule is disabled, because the optional Levenshtein package <https://pypi.org/project/python-Levenshtein/> is unavailable. Install Levenhstein (e.g. `pip install python-Levenshtein`) to suppress this warning.
  warnings.warn(msg)
/anaconda/envs/tf/lib/python3.9/site-packages/spacy/language.py:1895: UserWarning: [W123] Argument disable with value ['tagger', 'parser', 'lemmatizer', 'ner', 'textcat'] is used instead of ['senter'] as specified in the config. Be aware that this might affect other components in your pipeline.
  warnings.warn(
2023-03-10 07:13:32.299004: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:13:32.813509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13702 MB memory:  -> device: 0, name: Tesla T4, pci bus id: 0001:00:00.0, compute capability: 7.5
Using custom data configuration CEBaB--CEBaB-06a8703c20d64878
Found cached dataset parquet (/home/t-abkumar/.cache/huggingface/datasets/CEBaB___parquet/CEBaB--CEBaB-06a8703c20d64878/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
Namespace(expt_name='cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)', run_num=8, num_sample=1100, num_topics=1, num_topic_samples=None, l1_lambda=0.0, lr=5e-05, batch_size=32, max_len=80, path='dataset/cebab/', out_path='dataset/cebab', task_name='sentiment', spurious_ratio=None, causal_ratio=None, topic0_corr=None, topic1_corr=None, noise_ratio=0.0, main_topic=None, num_hidden_layer=0, removal_mode=None, main_model_mode='non_causal', head_retrain_mode=None, l2_lambd=0.0, loss_type='x_entropy', dtype='cebab', inv_dims=None, tab_sigma_ubound=None, dropout_rate=0.0, save_emb=False, neg_topic_corr=None, neg1_flip_method=None, measure_flip_pdelta=False, gpu_num=0, valid_before_gupdate=False, add_treatment_on_front=False, concat_word_emb=False, round_gval=False, cfactuals_bsize=1, num_pos_sample=None, num_neg_sample=None, cont_lambda=None, norm_lambda=None, inv_idx=None, closs_type=None, t0_ate=None, t1_ate=None, ate_noise=None, stage_mode='stage1_riesz', teloss_type=None, te_lambda=None, hinge_width=None, num_postalpha_layer=0, rr_lambda=1.0, tmle_lambda=0.0, reg_lambda=1.0, sp_topic_pval=None, return_label_dataset=False, degree_confoundedness=None, cebab_topic_name='food', topic_pval=inf, separate_cebab_de=False, only_de=False, num_sample_cebab_all=None, topic_name=None, replace_strategy=None, treated_topic=None, adv_rm_epochs=None, rev_grad_strength=None, adv_rm_method=None, stage=None, debug_cidx=None, debug_tidx=0, reverse_grad=False, topic_epochs=None, num_proj_iter=None, hlayer_dim=None, emb_path='glove-wiki-gigaword-100', extend_topic_set=False, vocab_path='assets/word2vec_10000_200d_labels.tsv', num_neigh=None, train_emb=False, normalize_emb=True, temb_dim=None, normalize_temb=False, tfreq_ulim=1.0, transformer='bert-base-uncased', num_epochs=20, load_weight_exp=None, load_weight_epoch=None, gate_weight_exp=None, gate_weight_epoch=None, gate_var_cutoff=None, bert_as_encoder=True, train_bert=True, cached_bemb=False)
Using GPU No: 0
1 Physical GPUs, 1 Logical GPU
Creating log file in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)
Creating the dataset
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 646.33it/s]
Some layers from the model checkpoint at bert-base-uncased were not used when initializing TFBertModel: ['mlm___cls', 'nsp___cls']
- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFBertModel were initialized from the model checkpoint at bert-base-uncased.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
Reading the data into dataframe!
Number of examples post first filtering:  11520
Merging the example and their counterfactuals into one!
Avg. number of counterfactual per example: 1.194319880418535
Number of example pre symmetrizing:  669
Number of example post symmetrizing: 1468
Number of Example post merging:  1468
positive sentiment ratio:  0.5
Estimated p-value in the current dataset:  0.7772727272727272
ATE for food:  0.424390243902439
Creating the model
Dumping the config in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/config.json
Initializing the BERT model: bert-base-uncased
Starting the training steps!
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:41,  1.23s/it, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:41,  1.23s/it, Batch:35  bidx:1]  6%|▌         | 2/35 [00:02<00:34,  1.05s/it, Batch:35  bidx:1]  6%|▌         | 2/35 [00:02<00:34,  1.05s/it, Batch:35  bidx:2]  9%|▊         | 3/35 [00:03<00:31,  1.00it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:03<00:31,  1.00it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:04<00:30,  1.03it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:04<00:30,  1.03it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.06it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.06it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.07it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.07it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:27,  1.00s/it, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:27,  1.00s/it, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:25,  1.03it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:25,  1.03it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.06it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.06it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.06it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.06it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.07it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:17,  1.08it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:17,  1.08it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:16,  1.08it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:16,  1.08it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:15,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:15,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:14,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:14,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:13,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:13,  1.07it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.07it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.07it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.07it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.07it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.07it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.07it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.07it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.07it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.07it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.07it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.07it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.07it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.07it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.07it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.07it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.07it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.07it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.07it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.07it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.07it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.07it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.07it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.07it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.07it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.07it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.07it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.07it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.07it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.13it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.06it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		0
reg_loss_valid:		0.110
rr_loss_valid:		-2.849
reg_acc_valid:		0.878
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		1.767
l2_loss:		0.000
emb_norm:		17.883
te_train:		0.342
te_corr_train:		2.070
te_dr_train:		0.340
te_valid:		0.468
te_corr_valid:		3.036
te_dr_valid:		0.499


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:32,  1.04it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:32,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.06it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.06it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:29,  1.07it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:29,  1.07it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:28,  1.07it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:28,  1.07it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:27,  1.08it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:27,  1.08it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:26,  1.08it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:26,  1.08it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.08it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.08it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.08it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.08it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.07it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.07it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.07it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.07it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.07it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.07it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.07it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.07it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.07it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.07it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.07it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:13<00:18,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:13<00:18,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:14<00:17,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:14<00:17,  1.07it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:15<00:16,  1.07it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:15<00:16,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:16<00:15,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:16<00:15,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:17<00:14,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:17<00:14,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.07it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.07it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.07it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.07it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.07it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.07it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.07it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.07it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.07it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.07it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.07it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.07it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.07it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.07it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.07it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.07it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.07it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.07it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.07it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.07it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.07it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:28<00:03,  1.07it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:28<00:03,  1.07it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:29<00:02,  1.07it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:29<00:02,  1.07it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:30<00:01,  1.07it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:30<00:01,  1.07it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:31<00:00,  1.07it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:31<00:00,  1.07it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.13it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.07it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		1
reg_loss_valid:		0.105
rr_loss_valid:		-3.227
reg_acc_valid:		0.903
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.585
l2_loss:		0.000
emb_norm:		16.937
te_train:		0.465
te_corr_train:		3.948
te_dr_train:		0.434
te_valid:		0.379
te_corr_valid:		3.792
te_dr_valid:		0.481


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:32,  1.04it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:32,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.06it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.06it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.06it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.06it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.07it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.07it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.07it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.07it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.07it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.07it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.07it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.07it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.07it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.07it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.07it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.07it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.07it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.07it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.07it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.07it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.07it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.07it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.07it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.07it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.07it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:14<00:17,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:14<00:17,  1.07it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:15<00:16,  1.07it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:15<00:16,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:16<00:15,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:16<00:15,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:17<00:14,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:17<00:14,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.07it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.07it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.07it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:13,  1.00s/it, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:13,  1.00s/it, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.02it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.02it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.03it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.06it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.06it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.06it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.06it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.06it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.06it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.06it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.06it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.06it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.06it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.06it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.06it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.06it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.06it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.12it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.07it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		2
reg_loss_valid:		0.092
rr_loss_valid:		-3.250
reg_acc_valid:		0.912
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.783
l2_loss:		0.000
emb_norm:		18.520
te_train:		0.424
te_corr_train:		4.188
te_dr_train:		0.440
te_valid:		0.525
te_corr_valid:		4.526
te_dr_valid:		0.520


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.05it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.05it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.06it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.06it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.06it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.06it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.07it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.07it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.07it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.07it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.07it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.07it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.07it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.07it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.07it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.07it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.07it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.07it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.07it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.07it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.07it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.07it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.06it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.06it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.07it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:17,  1.07it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:17,  1.07it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:15<00:16,  1.07it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:15<00:16,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:16<00:15,  1.07it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:16<00:15,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:17<00:15,  1.07it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:17<00:15,  1.07it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.06it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.06it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.06it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.06it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.06it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.06it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.06it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.06it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.06it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.06it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.06it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.06it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.06it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.06it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.06it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.06it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.06it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.06it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.06it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.06it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.06it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.06it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.06it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.06it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.06it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.06it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.06it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.06it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.06it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.06it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.12it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:32<00:00,  1.07it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		3
reg_loss_valid:		0.061
rr_loss_valid:		-3.182
reg_acc_valid:		0.937
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.899
l2_loss:		0.000
emb_norm:		18.233
te_train:		0.451
te_corr_train:		4.306
te_dr_train:		0.463
te_valid:		0.524
te_corr_valid:		4.086
te_dr_valid:		0.523


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.05it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.05it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.05it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.06it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.06it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.06it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.06it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.06it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.06it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.06it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.06it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.06it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.06it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.06it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.06it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.06it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.06it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.06it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.06it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.06it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.06it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.06it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:18,  1.06it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:17,  1.06it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:17,  1.06it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.06it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.06it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.06it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.06it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.06it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.06it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.06it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:18<00:14,  1.06it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.06it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:19<00:13,  1.06it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.06it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.06it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.06it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.06it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.06it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.06it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.06it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.06it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.06it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.06it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.06it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.06it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.12it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.06it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		4
reg_loss_valid:		0.071
rr_loss_valid:		-2.519
reg_acc_valid:		0.937
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.181
l2_loss:		0.000
emb_norm:		18.708
te_train:		0.458
te_corr_train:		4.603
te_dr_train:		0.463
te_valid:		0.401
te_corr_valid:		3.743
te_dr_valid:		0.567


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:03<00:34,  1.06s/it, Batch:35  bidx:2]  9%|▊         | 3/35 [00:03<00:34,  1.06s/it, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:04<00:31,  1.02s/it, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:04<00:31,  1.02s/it, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:05<00:29,  1.01it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:05<00:29,  1.01it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:28,  1.02it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:28,  1.02it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:27,  1.03it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:27,  1.03it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		5
reg_loss_valid:		0.094
rr_loss_valid:		-0.958
reg_acc_valid:		0.908
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.204
l2_loss:		0.000
emb_norm:		18.674
te_train:		0.438
te_corr_train:		4.842
te_dr_train:		0.468
te_valid:		0.507
te_corr_valid:		4.343
te_dr_valid:		0.340


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		6
reg_loss_valid:		0.082
rr_loss_valid:		-1.933
reg_acc_valid:		0.908
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.493
l2_loss:		0.000
emb_norm:		19.346
te_train:		0.531
te_corr_train:		5.097
te_dr_train:		0.478
te_valid:		0.360
te_corr_valid:		3.933
te_dr_valid:		0.536


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:16,  1.02s/it, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:16,  1.02s/it, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:15,  1.00s/it, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:15,  1.00s/it, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.01it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.01it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.02it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.02it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.03it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.04it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		7
reg_loss_valid:		0.119
rr_loss_valid:		-2.166
reg_acc_valid:		0.849
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.088
l2_loss:		0.000
emb_norm:		19.756
te_train:		0.515
te_corr_train:		4.791
te_dr_train:		0.570
te_valid:		0.420
te_corr_valid:		4.147
te_dr_valid:		0.572


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.03it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.05it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.05it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.05it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:20<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		8
reg_loss_valid:		0.107
rr_loss_valid:		7.480
reg_acc_valid:		0.840
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.242
l2_loss:		0.000
emb_norm:		19.958
te_train:		0.437
te_corr_train:		4.988
te_dr_train:		0.456
te_valid:		0.518
te_corr_valid:		5.455
te_dr_valid:		0.109


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:21<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.03it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.04it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		9
reg_loss_valid:		0.103
rr_loss_valid:		20.473
reg_acc_valid:		0.891
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.727
l2_loss:		0.000
emb_norm:		20.106
te_train:		0.561
te_corr_train:		6.284
te_dr_train:		0.553
te_valid:		0.568
te_corr_valid:		6.813
te_dr_valid:		0.217


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:34,  1.01s/it, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:34,  1.01s/it, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.03it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		10
reg_loss_valid:		0.144
rr_loss_valid:		44.283
reg_acc_valid:		0.828
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.536
l2_loss:		0.000
emb_norm:		21.163
te_train:		0.480
te_corr_train:		6.542
te_dr_train:		0.458
te_valid:		0.253
te_corr_valid:		8.153
te_dr_valid:		1.169


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:23,  1.02s/it, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:23,  1.02s/it, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:22,  1.00s/it, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:22,  1.00s/it, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.01it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.01it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.02it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.02it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.03it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.03it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.04it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.04it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.05it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.04it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		11
reg_loss_valid:		0.145
rr_loss_valid:		8.329
reg_acc_valid:		0.845
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.194
l2_loss:		0.000
emb_norm:		22.219
te_train:		0.392
te_corr_train:		4.846
te_dr_train:		0.468
te_valid:		0.363
te_corr_valid:		3.367
te_dr_valid:		0.210


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.03it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.05it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.04it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:20,  1.02s/it, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:20,  1.02s/it, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:19,  1.00s/it, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:19,  1.00s/it, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.01it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.01it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.02it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.02it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.03it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.03it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.03it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.03it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.04it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.04it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		12
reg_loss_valid:		0.088
rr_loss_valid:		-0.646
reg_acc_valid:		0.887
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.697
l2_loss:		0.000
emb_norm:		22.876
te_train:		0.535
te_corr_train:		4.543
te_dr_train:		0.494
te_valid:		0.463
te_corr_valid:		3.890
te_dr_valid:		0.404


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		13
reg_loss_valid:		0.144
rr_loss_valid:		10.001
reg_acc_valid:		0.870
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.634
l2_loss:		0.000
emb_norm:		22.185
te_train:		0.530
te_corr_train:		4.843
te_dr_train:		0.524
te_valid:		0.477
te_corr_valid:		5.233
te_dr_valid:		-0.238


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:33,  1.00it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.04it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.04it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:04,  1.02s/it, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:04,  1.02s/it, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:03,  1.00s/it, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:03,  1.00s/it, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.01it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.01it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.02it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.02it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.09it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.04it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		14
reg_loss_valid:		0.125
rr_loss_valid:		9.526
reg_acc_valid:		0.866
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.736
l2_loss:		0.000
emb_norm:		21.884
te_train:		0.552
te_corr_train:		6.024
te_dr_train:		0.504
te_valid:		0.388
te_corr_valid:		5.154
te_dr_valid:		0.275


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:31,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.05it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.05it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.05it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:22<00:10,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:23<00:09,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.04it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.05it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.05it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.11it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		15
reg_loss_valid:		0.075
rr_loss_valid:		-1.718
reg_acc_valid:		0.899
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.830
l2_loss:		0.000
emb_norm:		21.760
te_train:		0.565
te_corr_train:		6.927
te_dr_train:		0.569
te_valid:		0.439
te_corr_valid:		3.958
te_dr_valid:		0.566


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.00it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.02it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.03it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:25,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:24,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:24,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:23,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:23,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.04it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.04it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.04it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.04it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.04it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:24<00:08,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:25<00:07,  1.04it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.04it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:26<00:06,  1.04it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.04it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:27<00:05,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:28<00:04,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:29<00:03,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:30<00:02,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:31<00:01,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:32<00:00,  1.04it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.10it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.05it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		16
reg_loss_valid:		0.100
rr_loss_valid:		15.748
reg_acc_valid:		0.891
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.275
l2_loss:		0.000
emb_norm:		21.490
te_train:		0.532
te_corr_train:		6.165
te_dr_train:		0.550
te_valid:		0.541
te_corr_valid:		5.664
te_dr_valid:		0.011


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.02it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:30,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:28,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:26,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:27,  1.01s/it, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:27,  1.01s/it, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:25,  1.01it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:25,  1.01it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:24,  1.02it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:24,  1.02it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:23,  1.02it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:23,  1.02it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.03it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.03it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.03it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.03it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.03it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.03it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.03it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.03it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:18,  1.04s/it, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:18,  1.04s/it, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:17,  1.02s/it, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:17,  1.02s/it, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:16,  1.00s/it, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:16,  1.00s/it, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.01it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.01it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.02it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.02it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.02it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.02it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.03it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.03it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.03it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.03it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.03it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.03it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.04it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.04it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.03it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.03it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:28<00:05,  1.04it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:28<00:05,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:29<00:04,  1.04it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:29<00:04,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:30<00:03,  1.04it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:33<00:03,  1.04it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:34<00:05,  1.91s/it, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:34<00:05,  1.91s/it, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:35<00:03,  1.63s/it, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:35<00:03,  1.63s/it, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:36<00:01,  1.43s/it, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:36<00:01,  1.43s/it, Batch:35  bidx:34]100%|██████████| 35/35 [00:37<00:00,  1.23s/it, Batch:35  bidx:34]100%|██████████| 35/35 [00:37<00:00,  1.06s/it, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		17
reg_loss_valid:		0.129
rr_loss_valid:		38.655
reg_acc_valid:		0.853
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.484
l2_loss:		0.000
emb_norm:		20.784
te_train:		0.579
te_corr_train:		7.590
te_dr_train:		0.568
te_valid:		0.479
te_corr_valid:		6.351
te_dr_valid:		-0.275


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:34,  1.01s/it, Batch:35  bidx:0]  3%|▎         | 1/35 [00:01<00:34,  1.01s/it, Batch:35  bidx:1]  6%|▌         | 2/35 [00:02<00:35,  1.07s/it, Batch:35  bidx:1]  6%|▌         | 2/35 [00:02<00:35,  1.07s/it, Batch:35  bidx:2]  9%|▊         | 3/35 [00:03<00:32,  1.02s/it, Batch:35  bidx:2]  9%|▊         | 3/35 [00:03<00:32,  1.02s/it, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:04<00:30,  1.00it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:04<00:30,  1.00it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:05<00:29,  1.01it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:05<00:29,  1.01it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:28,  1.02it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:28,  1.02it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:27,  1.03it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:27,  1.03it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:26,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:26,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:24,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:23,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:22,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.04it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.04it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.03it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.03it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.03it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.03it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.03it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.03it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.03it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.03it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.03it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.03it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.03it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.03it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.03it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.03it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.03it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:09,  1.03it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.03it/s, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:08,  1.03it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.03it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.03it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.03it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.03it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:28<00:05,  1.03it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:28<00:05,  1.03it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:29<00:04,  1.03it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:29<00:04,  1.03it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:30<00:03,  1.03it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:30<00:03,  1.03it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:31<00:02,  1.03it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:31<00:02,  1.03it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:32<00:01,  1.03it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:32<00:01,  1.03it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:33<00:00,  1.03it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:33<00:00,  1.03it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.09it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.04it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		18
reg_loss_valid:		0.263
rr_loss_valid:		152.552
reg_acc_valid:		0.731
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.440
l2_loss:		0.000
emb_norm:		20.601
te_train:		0.539
te_corr_train:		8.763
te_dr_train:		0.594
te_valid:		0.496
te_corr_valid:		13.771
te_dr_valid:		-1.942


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/35 [00:00<?, ?it/s]  0%|          | 0/35 [00:00<?, ?it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:0]  3%|▎         | 1/35 [00:00<00:33,  1.01it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:1]  6%|▌         | 2/35 [00:01<00:32,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:31,  1.03it/s, Batch:35  bidx:2]  9%|▊         | 3/35 [00:02<00:31,  1.03it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:3] 11%|█▏        | 4/35 [00:03<00:29,  1.04it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:29,  1.03it/s, Batch:35  bidx:4] 14%|█▍        | 5/35 [00:04<00:29,  1.03it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:5] 17%|█▋        | 6/35 [00:05<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:27,  1.04it/s, Batch:35  bidx:6] 20%|██        | 7/35 [00:06<00:27,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:26,  1.04it/s, Batch:35  bidx:7] 23%|██▎       | 8/35 [00:07<00:26,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:25,  1.04it/s, Batch:35  bidx:8] 26%|██▌       | 9/35 [00:08<00:25,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:24,  1.04it/s, Batch:35  bidx:9] 29%|██▊       | 10/35 [00:09<00:24,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:23,  1.04it/s, Batch:35  bidx:10] 31%|███▏      | 11/35 [00:10<00:23,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:11] 34%|███▍      | 12/35 [00:11<00:22,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.04it/s, Batch:35  bidx:12] 37%|███▋      | 13/35 [00:12<00:21,  1.04it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.03it/s, Batch:35  bidx:13] 40%|████      | 14/35 [00:13<00:20,  1.03it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:14] 43%|████▎     | 15/35 [00:14<00:19,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:15] 46%|████▌     | 16/35 [00:15<00:18,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:16] 49%|████▊     | 17/35 [00:16<00:17,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:17] 51%|█████▏    | 18/35 [00:17<00:16,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.04it/s, Batch:35  bidx:18] 54%|█████▍    | 19/35 [00:18<00:15,  1.04it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.04it/s, Batch:35  bidx:19] 57%|█████▋    | 20/35 [00:19<00:14,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:20] 60%|██████    | 21/35 [00:20<00:13,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:21] 63%|██████▎   | 22/35 [00:21<00:12,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.04it/s, Batch:35  bidx:22] 66%|██████▌   | 23/35 [00:22<00:11,  1.04it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.03it/s, Batch:35  bidx:23] 69%|██████▊   | 24/35 [00:23<00:10,  1.03it/s, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:10,  1.03s/it, Batch:35  bidx:24] 71%|███████▏  | 25/35 [00:24<00:10,  1.03s/it, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:09,  1.01s/it, Batch:35  bidx:25] 74%|███████▍  | 26/35 [00:25<00:09,  1.01s/it, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.00it/s, Batch:35  bidx:26] 77%|███████▋  | 27/35 [00:26<00:07,  1.00it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.01it/s, Batch:35  bidx:27] 80%|████████  | 28/35 [00:27<00:06,  1.01it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:28<00:05,  1.02it/s, Batch:35  bidx:28] 83%|████████▎ | 29/35 [00:28<00:05,  1.02it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:29<00:04,  1.02it/s, Batch:35  bidx:29] 86%|████████▌ | 30/35 [00:29<00:04,  1.02it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:30<00:03,  1.02it/s, Batch:35  bidx:30] 89%|████████▊ | 31/35 [00:30<00:03,  1.02it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:31<00:02,  1.03it/s, Batch:35  bidx:31] 91%|█████████▏| 32/35 [00:31<00:02,  1.03it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:32<00:01,  1.03it/s, Batch:35  bidx:32] 94%|█████████▍| 33/35 [00:32<00:01,  1.03it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:33<00:00,  1.03it/s, Batch:35  bidx:33] 97%|█████████▋| 34/35 [00:33<00:00,  1.03it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.09it/s, Batch:35  bidx:34]100%|██████████| 35/35 [00:33<00:00,  1.03it/s, Batch:35  bidx:34]
Validating the cf-dataset
epoch:		19
reg_loss_valid:		0.287
rr_loss_valid:		217.747
reg_acc_valid:		0.769
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.505
l2_loss:		0.000
emb_norm:		21.900
te_train:		0.624
te_corr_train:		10.016
te_dr_train:		0.619
te_valid:		0.577
te_corr_valid:		14.923
te_dr_valid:		-3.638


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(1100).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(food)/probe_metric_list.json
2023-03-10 07:29:11.101216: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:29:11.251955: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-03-10 07:29:11.780780: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:29:11.780906: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:29:11.780925: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
/anaconda/envs/tf/lib/python3.9/site-packages/gensim/similarities/__init__.py:15: UserWarning: The gensim.similarities.levenshtein submodule is disabled, because the optional Levenshtein package <https://pypi.org/project/python-Levenshtein/> is unavailable. Install Levenhstein (e.g. `pip install python-Levenshtein`) to suppress this warning.
  warnings.warn(msg)
/anaconda/envs/tf/lib/python3.9/site-packages/spacy/language.py:1895: UserWarning: [W123] Argument disable with value ['tagger', 'parser', 'lemmatizer', 'ner', 'textcat'] is used instead of ['senter'] as specified in the config. Be aware that this might affect other components in your pipeline.
  warnings.warn(
2023-03-10 07:29:14.783473: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:29:15.268984: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13702 MB memory:  -> device: 0, name: Tesla T4, pci bus id: 0001:00:00.0, compute capability: 7.5
Using custom data configuration CEBaB--CEBaB-06a8703c20d64878
Found cached dataset parquet (/home/t-abkumar/.cache/huggingface/datasets/CEBaB___parquet/CEBaB--CEBaB-06a8703c20d64878/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
Namespace(expt_name='cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)', run_num=8, num_sample=900, num_topics=1, num_topic_samples=None, l1_lambda=0.0, lr=5e-05, batch_size=32, max_len=80, path='dataset/cebab/', out_path='dataset/cebab', task_name='sentiment', spurious_ratio=None, causal_ratio=None, topic0_corr=None, topic1_corr=None, noise_ratio=0.0, main_topic=None, num_hidden_layer=0, removal_mode=None, main_model_mode='non_causal', head_retrain_mode=None, l2_lambd=0.0, loss_type='x_entropy', dtype='cebab', inv_dims=None, tab_sigma_ubound=None, dropout_rate=0.0, save_emb=False, neg_topic_corr=None, neg1_flip_method=None, measure_flip_pdelta=False, gpu_num=0, valid_before_gupdate=False, add_treatment_on_front=False, concat_word_emb=False, round_gval=False, cfactuals_bsize=1, num_pos_sample=None, num_neg_sample=None, cont_lambda=None, norm_lambda=None, inv_idx=None, closs_type=None, t0_ate=None, t1_ate=None, ate_noise=None, stage_mode='stage1_riesz', teloss_type=None, te_lambda=None, hinge_width=None, num_postalpha_layer=0, rr_lambda=1.0, tmle_lambda=0.0, reg_lambda=1.0, sp_topic_pval=None, return_label_dataset=False, degree_confoundedness=None, cebab_topic_name='service', topic_pval=inf, separate_cebab_de=False, only_de=False, num_sample_cebab_all=None, topic_name=None, replace_strategy=None, treated_topic=None, adv_rm_epochs=None, rev_grad_strength=None, adv_rm_method=None, stage=None, debug_cidx=None, debug_tidx=0, reverse_grad=False, topic_epochs=None, num_proj_iter=None, hlayer_dim=None, emb_path='glove-wiki-gigaword-100', extend_topic_set=False, vocab_path='assets/word2vec_10000_200d_labels.tsv', num_neigh=None, train_emb=False, normalize_emb=True, temb_dim=None, normalize_temb=False, tfreq_ulim=1.0, transformer='bert-base-uncased', num_epochs=20, load_weight_exp=None, load_weight_epoch=None, gate_weight_exp=None, gate_weight_epoch=None, gate_var_cutoff=None, bert_as_encoder=True, train_bert=True, cached_bemb=False)
Using GPU No: 0
1 Physical GPUs, 1 Logical GPU
Creating log file in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)
Creating the dataset
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 662.04it/s]
Some layers from the model checkpoint at bert-base-uncased were not used when initializing TFBertModel: ['nsp___cls', 'mlm___cls']
- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFBertModel were initialized from the model checkpoint at bert-base-uncased.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
Reading the data into dataframe!
Number of examples post first filtering:  11550
Merging the example and their counterfactuals into one!
Avg. number of counterfactual per example: 1.1870748299319729
Number of example pre symmetrizing:  588
Number of example post symmetrizing: 1286
Number of Example post merging:  1286
positive sentiment ratio:  0.5
Estimated p-value in the current dataset:  0.6322222222222222
ATE for service:  0.16435643564356436
Creating the model
Dumping the config in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/config.json
Initializing the BERT model: bert-base-uncased
Starting the training steps!
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:01<00:35,  1.26s/it, Batch:29  bidx:0]  3%|▎         | 1/29 [00:01<00:35,  1.26s/it, Batch:29  bidx:1]  7%|▋         | 2/29 [00:02<00:28,  1.07s/it, Batch:29  bidx:1]  7%|▋         | 2/29 [00:02<00:28,  1.07s/it, Batch:29  bidx:2] 10%|█         | 3/29 [00:03<00:26,  1.01s/it, Batch:29  bidx:2] 10%|█         | 3/29 [00:03<00:26,  1.01s/it, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:04<00:24,  1.01it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:04<00:24,  1.01it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:05<00:23,  1.03it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:05<00:23,  1.03it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:07<00:22,  1.01s/it, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:07<00:22,  1.01s/it, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:08<00:20,  1.01it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:08<00:20,  1.01it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:09<00:19,  1.02it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:09<00:19,  1.02it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.03it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.03it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		0
reg_loss_valid:		0.144
rr_loss_valid:		-3.146
reg_acc_valid:		0.801
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		1.529
l2_loss:		0.000
emb_norm:		17.596
te_train:		0.190
te_corr_train:		1.587
te_dr_train:		0.185
te_valid:		0.284
te_corr_valid:		3.223
te_dr_valid:		0.282


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.04it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.05it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		1
reg_loss_valid:		0.115
rr_loss_valid:		-3.510
reg_acc_valid:		0.821
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.383
l2_loss:		0.000
emb_norm:		17.830
te_train:		0.225
te_corr_train:		3.548
te_dr_train:		0.219
te_valid:		0.351
te_corr_valid:		3.735
te_dr_valid:		0.282


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:20,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		2
reg_loss_valid:		0.113
rr_loss_valid:		-3.066
reg_acc_valid:		0.852
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.779
l2_loss:		0.000
emb_norm:		17.908
te_train:		0.199
te_corr_train:		3.984
te_dr_train:		0.213
te_valid:		0.236
te_corr_valid:		3.820
te_dr_valid:		0.267


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.02it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.02it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:03<00:27,  1.07s/it, Batch:29  bidx:2] 10%|█         | 3/29 [00:03<00:27,  1.07s/it, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:04<00:25,  1.02s/it, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:04<00:25,  1.02s/it, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:05<00:23,  1.00it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:05<00:23,  1.00it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.02it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.02it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.03it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		3
reg_loss_valid:		0.066
rr_loss_valid:		-3.282
reg_acc_valid:		0.954
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.088
l2_loss:		0.000
emb_norm:		18.183
te_train:		0.253
te_corr_train:		4.161
te_dr_train:		0.173
te_valid:		0.163
te_corr_valid:		4.250
te_dr_valid:		0.224


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.02it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.02it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:25,  1.04it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.05it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.05it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:20,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.06it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		4
reg_loss_valid:		0.089
rr_loss_valid:		-3.085
reg_acc_valid:		0.908
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.020
l2_loss:		0.000
emb_norm:		17.905
te_train:		0.103
te_corr_train:		4.244
te_dr_train:		0.182
te_valid:		0.013
te_corr_valid:		3.963
te_dr_valid:		0.232


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:01,  1.02s/it, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:01,  1.02s/it, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.08it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		5
reg_loss_valid:		0.071
rr_loss_valid:		-1.805
reg_acc_valid:		0.954
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.051
l2_loss:		0.000
emb_norm:		17.953
te_train:		0.191
te_corr_train:		4.300
te_dr_train:		0.158
te_valid:		0.284
te_corr_valid:		4.760
te_dr_valid:		0.327


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.04it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.05it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.05it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.05it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:21<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		6
reg_loss_valid:		0.121
rr_loss_valid:		4.732
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.737
l2_loss:		0.000
emb_norm:		17.389
te_train:		0.188
te_corr_train:		5.250
te_dr_train:		0.166
te_valid:		0.164
te_corr_valid:		4.992
te_dr_valid:		0.326


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:01<00:28,  1.00s/it, Batch:29  bidx:0]  3%|▎         | 1/29 [00:01<00:28,  1.00s/it, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.02it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.02it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.03it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.03it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.03it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.03it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.03it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.03it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.03it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.03it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.03it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.03it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.03it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.03it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.03it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.03it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.03it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.03it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.03it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.03it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.03it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.03it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		7
reg_loss_valid:		0.107
rr_loss_valid:		0.556
reg_acc_valid:		0.857
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.894
l2_loss:		0.000
emb_norm:		16.914
te_train:		0.198
te_corr_train:		5.372
te_dr_train:		0.218
te_valid:		0.396
te_corr_valid:		4.986
te_dr_valid:		0.182


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.03it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.03it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.03it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.03it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.03it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.03it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.03it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.03it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.03it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.03it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.03it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:06,  1.03s/it, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:06,  1.03s/it, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:05,  1.01s/it, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:05,  1.01s/it, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.00it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.00it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.01it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.01it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.02it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.02it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.02it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.02it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:28<00:00,  1.11it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:28<00:00,  1.04it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		8
reg_loss_valid:		0.079
rr_loss_valid:		-1.028
reg_acc_valid:		0.898
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.397
l2_loss:		0.000
emb_norm:		18.572
te_train:		0.202
te_corr_train:		4.737
te_dr_train:		0.204
te_valid:		0.371
te_corr_valid:		5.219
te_dr_valid:		0.141


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.05it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:22<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		9
reg_loss_valid:		0.142
rr_loss_valid:		22.619
reg_acc_valid:		0.857
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.596
l2_loss:		0.000
emb_norm:		18.859
te_train:		0.159
te_corr_train:		5.615
te_dr_train:		0.149
te_valid:		0.319
te_corr_valid:		8.297
te_dr_valid:		-0.139


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		10
reg_loss_valid:		0.176
rr_loss_valid:		54.277
reg_acc_valid:		0.806
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.625
l2_loss:		0.000
emb_norm:		18.458
te_train:		0.146
te_corr_train:		8.520
te_dr_train:		0.171
te_valid:		0.191
te_corr_valid:		7.657
te_dr_valid:		0.346


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.02it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.02it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.04it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:08,  1.02s/it, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:08,  1.02s/it, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:07,  1.00s/it, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:07,  1.00s/it, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.01it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.01it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.02it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.02it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.03it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.03it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.03it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.03it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.03it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.03it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		11
reg_loss_valid:		0.143
rr_loss_valid:		-0.811
reg_acc_valid:		0.816
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		8.379
l2_loss:		0.000
emb_norm:		18.402
te_train:		0.128
te_corr_train:		9.347
te_dr_train:		0.074
te_valid:		0.270
te_corr_valid:		3.602
te_dr_valid:		0.223


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.05it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.05it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.05it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		12
reg_loss_valid:		0.151
rr_loss_valid:		69.689
reg_acc_valid:		0.786
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.162
l2_loss:		0.000
emb_norm:		18.680
te_train:		0.143
te_corr_train:		6.195
te_dr_train:		0.198
te_valid:		0.288
te_corr_valid:		8.848
te_dr_valid:		0.529


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		13
reg_loss_valid:		0.137
rr_loss_valid:		16.997
reg_acc_valid:		0.842
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		6.395
l2_loss:		0.000
emb_norm:		17.861
te_train:		0.131
te_corr_train:		8.116
te_dr_train:		0.249
te_valid:		0.319
te_corr_valid:		5.731
te_dr_valid:		-0.098


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:12,  1.02s/it, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:12,  1.02s/it, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:11,  1.01s/it, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:11,  1.01s/it, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.01it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.01it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.02it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.02it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.02it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.02it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.03it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.03it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.03it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.03it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.03it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.03it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.03it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.03it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.11it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		14
reg_loss_valid:		0.155
rr_loss_valid:		37.581
reg_acc_valid:		0.781
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		6.985
l2_loss:		0.000
emb_norm:		17.308
te_train:		0.218
te_corr_train:		9.252
te_dr_train:		0.202
te_valid:		0.042
te_corr_valid:		5.771
te_dr_valid:		0.440


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:01<00:28,  1.00s/it, Batch:29  bidx:0]  3%|▎         | 1/29 [00:01<00:28,  1.00s/it, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.03it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.03it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.03it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.03it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.03it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.03it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.03it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.03it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.03it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.03it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.03it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.03it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.03it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.05it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		15
reg_loss_valid:		0.139
rr_loss_valid:		30.338
reg_acc_valid:		0.821
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.494
l2_loss:		0.000
emb_norm:		17.327
te_train:		0.111
te_corr_train:		8.188
te_dr_train:		0.123
te_valid:		0.315
te_corr_valid:		6.244
te_dr_valid:		0.137


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.00it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.05it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.05it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.13it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		16
reg_loss_valid:		0.155
rr_loss_valid:		88.269
reg_acc_valid:		0.847
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		6.337
l2_loss:		0.000
emb_norm:		19.316
te_train:		0.217
te_corr_train:		11.317
te_dr_train:		0.276
te_valid:		0.306
te_corr_valid:		7.292
te_dr_valid:		-0.563


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.03it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:25,  1.04it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.05it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:22,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.05it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:13,  1.02s/it, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:13,  1.02s/it, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:12,  1.00s/it, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:12,  1.00s/it, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.01it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.01it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.02it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.02it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.03it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.03it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.03it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.03it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:24<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:25<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:26<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.04it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		17
reg_loss_valid:		0.223
rr_loss_valid:		229.527
reg_acc_valid:		0.781
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.335
l2_loss:		0.000
emb_norm:		18.677
te_train:		0.277
te_corr_train:		11.813
te_dr_train:		0.234
te_valid:		0.452
te_corr_valid:		14.161
te_dr_valid:		-2.821


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.03it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:24,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.05it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		18
reg_loss_valid:		0.226
rr_loss_valid:		125.538
reg_acc_valid:		0.745
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		6.687
l2_loss:		0.000
emb_norm:		19.517
te_train:		0.293
te_corr_train:		10.830
te_dr_train:		0.218
te_valid:		0.181
te_corr_valid:		9.613
te_dr_valid:		0.309


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/29 [00:00<?, ?it/s]  0%|          | 0/29 [00:00<?, ?it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:0]  3%|▎         | 1/29 [00:00<00:27,  1.01it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:1]  7%|▋         | 2/29 [00:01<00:26,  1.03it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:2] 10%|█         | 3/29 [00:02<00:25,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:3] 14%|█▍        | 4/29 [00:03<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:4] 17%|█▋        | 5/29 [00:04<00:23,  1.04it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.05it/s, Batch:29  bidx:5] 21%|██        | 6/29 [00:05<00:22,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:6] 24%|██▍       | 7/29 [00:06<00:21,  1.05it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:7] 28%|██▊       | 8/29 [00:07<00:20,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:8] 31%|███       | 9/29 [00:08<00:19,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:9] 34%|███▍      | 10/29 [00:09<00:18,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:10] 38%|███▊      | 11/29 [00:10<00:17,  1.04it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:11] 41%|████▏     | 12/29 [00:11<00:16,  1.05it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:12] 45%|████▍     | 13/29 [00:12<00:15,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:13] 48%|████▊     | 14/29 [00:13<00:14,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:14] 52%|█████▏    | 15/29 [00:14<00:13,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:15] 55%|█████▌    | 16/29 [00:15<00:12,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:16] 59%|█████▊    | 17/29 [00:16<00:11,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:17] 62%|██████▏   | 18/29 [00:17<00:10,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:18] 66%|██████▌   | 19/29 [00:18<00:09,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:19] 69%|██████▉   | 20/29 [00:19<00:08,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:20] 72%|███████▏  | 21/29 [00:20<00:07,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:21] 76%|███████▌  | 22/29 [00:21<00:06,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:22] 79%|███████▉  | 23/29 [00:22<00:05,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:23] 83%|████████▎ | 24/29 [00:23<00:04,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:24] 86%|████████▌ | 25/29 [00:23<00:03,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:25] 90%|████████▉ | 26/29 [00:24<00:02,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:26] 93%|█████████▎| 27/29 [00:25<00:01,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:27] 97%|█████████▋| 28/29 [00:26<00:00,  1.04it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.12it/s, Batch:29  bidx:28]100%|██████████| 29/29 [00:27<00:00,  1.05it/s, Batch:29  bidx:28]
Validating the cf-dataset
epoch:		19
reg_loss_valid:		0.204
rr_loss_valid:		192.317
reg_acc_valid:		0.781
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		8.669
l2_loss:		0.000
emb_norm:		19.537
te_train:		0.201
te_corr_train:		14.184
te_dr_train:		0.348
te_valid:		0.309
te_corr_valid:		10.477
te_dr_valid:		-1.594


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(900).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(service)/probe_metric_list.json
2023-03-10 07:42:12.946777: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:42:13.102954: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-03-10 07:42:13.632196: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:42:13.632319: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:42:13.632338: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
/anaconda/envs/tf/lib/python3.9/site-packages/gensim/similarities/__init__.py:15: UserWarning: The gensim.similarities.levenshtein submodule is disabled, because the optional Levenshtein package <https://pypi.org/project/python-Levenshtein/> is unavailable. Install Levenhstein (e.g. `pip install python-Levenshtein`) to suppress this warning.
  warnings.warn(msg)
/anaconda/envs/tf/lib/python3.9/site-packages/spacy/language.py:1895: UserWarning: [W123] Argument disable with value ['tagger', 'parser', 'lemmatizer', 'ner', 'textcat'] is used instead of ['senter'] as specified in the config. Be aware that this might affect other components in your pipeline.
  warnings.warn(
2023-03-10 07:42:16.602007: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:42:17.109604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13702 MB memory:  -> device: 0, name: Tesla T4, pci bus id: 0001:00:00.0, compute capability: 7.5
Using custom data configuration CEBaB--CEBaB-06a8703c20d64878
Found cached dataset parquet (/home/t-abkumar/.cache/huggingface/datasets/CEBaB___parquet/CEBaB--CEBaB-06a8703c20d64878/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
Namespace(expt_name='cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)', run_num=8, num_sample=700, num_topics=1, num_topic_samples=None, l1_lambda=0.0, lr=5e-05, batch_size=32, max_len=80, path='dataset/cebab/', out_path='dataset/cebab', task_name='sentiment', spurious_ratio=None, causal_ratio=None, topic0_corr=None, topic1_corr=None, noise_ratio=0.0, main_topic=None, num_hidden_layer=0, removal_mode=None, main_model_mode='non_causal', head_retrain_mode=None, l2_lambd=0.0, loss_type='x_entropy', dtype='cebab', inv_dims=None, tab_sigma_ubound=None, dropout_rate=0.0, save_emb=False, neg_topic_corr=None, neg1_flip_method=None, measure_flip_pdelta=False, gpu_num=0, valid_before_gupdate=False, add_treatment_on_front=False, concat_word_emb=False, round_gval=False, cfactuals_bsize=1, num_pos_sample=None, num_neg_sample=None, cont_lambda=None, norm_lambda=None, inv_idx=None, closs_type=None, t0_ate=None, t1_ate=None, ate_noise=None, stage_mode='stage1_riesz', teloss_type=None, te_lambda=None, hinge_width=None, num_postalpha_layer=0, rr_lambda=1.0, tmle_lambda=0.0, reg_lambda=1.0, sp_topic_pval=None, return_label_dataset=False, degree_confoundedness=None, cebab_topic_name='ambiance', topic_pval=inf, separate_cebab_de=False, only_de=False, num_sample_cebab_all=None, topic_name=None, replace_strategy=None, treated_topic=None, adv_rm_epochs=None, rev_grad_strength=None, adv_rm_method=None, stage=None, debug_cidx=None, debug_tidx=0, reverse_grad=False, topic_epochs=None, num_proj_iter=None, hlayer_dim=None, emb_path='glove-wiki-gigaword-100', extend_topic_set=False, vocab_path='assets/word2vec_10000_200d_labels.tsv', num_neigh=None, train_emb=False, normalize_emb=True, temb_dim=None, normalize_temb=False, tfreq_ulim=1.0, transformer='bert-base-uncased', num_epochs=20, load_weight_exp=None, load_weight_epoch=None, gate_weight_exp=None, gate_weight_epoch=None, gate_var_cutoff=None, bert_as_encoder=True, train_bert=True, cached_bemb=False)
Using GPU No: 0
1 Physical GPUs, 1 Logical GPU
Creating log file in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)
Creating the dataset
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 643.18it/s]
Some layers from the model checkpoint at bert-base-uncased were not used when initializing TFBertModel: ['mlm___cls', 'nsp___cls']
- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFBertModel were initialized from the model checkpoint at bert-base-uncased.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
Reading the data into dataframe!
Number of examples post first filtering:  11525
Merging the example and their counterfactuals into one!
Avg. number of counterfactual per example: 1.176842105263158
Number of example pre symmetrizing:  475
Number of example post symmetrizing: 1034
Number of Example post merging:  1034
positive sentiment ratio:  0.5
Estimated p-value in the current dataset:  0.5342857142857143
ATE for ambiance:  0.07270408163265306
Creating the model
Dumping the config in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/config.json
Initializing the BERT model: bert-base-uncased
Starting the training steps!
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:26,  1.28s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:26,  1.28s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:02<00:21,  1.09s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:02<00:21,  1.09s/it, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:03<00:19,  1.02s/it, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:03<00:19,  1.02s/it, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:04<00:17,  1.01it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:04<00:17,  1.01it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:05<00:17,  1.03s/it, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:05<00:17,  1.03s/it, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:06<00:15,  1.00it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:06<00:15,  1.00it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:07<00:14,  1.02it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:07<00:14,  1.02it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:08<00:13,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:08<00:13,  1.03it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:09<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:09<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.05it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.05it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.05it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.05it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.05it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.05it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.05it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.05it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.05it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.05it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.05it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.05it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.05it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.05it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		0
reg_loss_valid:		0.201
rr_loss_valid:		-2.361
reg_acc_valid:		0.762
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		1.352
l2_loss:		0.000
emb_norm:		15.297
te_train:		0.146
te_corr_train:		1.263
te_dr_train:		0.039
te_valid:		-0.090
te_corr_valid:		3.080
te_dr_valid:		0.174


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.00s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.00s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.05it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.05it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.05it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.05it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.05it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.05it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.05it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.05it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.05it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.05it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.05it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.05it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.05it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.05it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		1
reg_loss_valid:		0.118
rr_loss_valid:		-3.175
reg_acc_valid:		0.864
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		2.724
l2_loss:		0.000
emb_norm:		17.421
te_train:		0.042
te_corr_train:		2.884
te_dr_train:		0.132
te_valid:		0.153
te_corr_valid:		3.304
te_dr_valid:		-0.018


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.00it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.00it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		2
reg_loss_valid:		0.172
rr_loss_valid:		-2.245
reg_acc_valid:		0.745
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.573
l2_loss:		0.000
emb_norm:		18.055
te_train:		0.142
te_corr_train:		3.585
te_dr_train:		0.129
te_valid:		0.053
te_corr_valid:		2.589
te_dr_valid:		-0.106


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		3
reg_loss_valid:		0.163
rr_loss_valid:		-2.923
reg_acc_valid:		0.684
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.624
l2_loss:		0.000
emb_norm:		17.394
te_train:		0.088
te_corr_train:		3.593
te_dr_train:		0.101
te_valid:		0.253
te_corr_valid:		3.577
te_dr_valid:		-0.066


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.00s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.00s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:03<00:20,  1.07s/it, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:03<00:20,  1.07s/it, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:04<00:18,  1.02s/it, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:04<00:18,  1.02s/it, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:05<00:16,  1.00it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:05<00:16,  1.00it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.02it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.02it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.02it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.02it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.03it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.03it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.05it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.05it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.05it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.05it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		4
reg_loss_valid:		0.140
rr_loss_valid:		-2.534
reg_acc_valid:		0.844
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.937
l2_loss:		0.000
emb_norm:		18.211
te_train:		0.196
te_corr_train:		4.088
te_dr_train:		0.185
te_valid:		0.110
te_corr_valid:		3.618
te_dr_valid:		-0.123


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.02s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.02s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.01it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.02it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.03it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.03it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.03it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.03it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.03it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.03it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.03it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.03it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.03it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.03it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		5
reg_loss_valid:		0.157
rr_loss_valid:		-0.311
reg_acc_valid:		0.848
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.099
l2_loss:		0.000
emb_norm:		18.636
te_train:		0.150
te_corr_train:		4.524
te_dr_train:		0.144
te_valid:		0.052
te_corr_valid:		3.584
te_dr_valid:		0.156


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.01it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.02it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.03it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.03it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.03it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.03it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.03it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.03it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.03it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.03it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.03it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.03it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.03it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		6
reg_loss_valid:		0.151
rr_loss_valid:		-0.385
reg_acc_valid:		0.762
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.722
l2_loss:		0.000
emb_norm:		17.951
te_train:		0.100
te_corr_train:		5.010
te_dr_train:		0.116
te_valid:		0.089
te_corr_valid:		3.162
te_dr_valid:		0.072


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.03it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.03it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.03it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.03it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.03it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.03it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.02s/it, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		7
reg_loss_valid:		0.149
rr_loss_valid:		4.787
reg_acc_valid:		0.742
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.658
l2_loss:		0.000
emb_norm:		15.748
te_train:		0.071
te_corr_train:		5.246
te_dr_train:		0.144
te_valid:		0.091
te_corr_valid:		3.540
te_dr_valid:		-0.029


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		8
reg_loss_valid:		0.205
rr_loss_valid:		-0.496
reg_acc_valid:		0.712
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.403
l2_loss:		0.000
emb_norm:		15.355
te_train:		0.058
te_corr_train:		3.632
te_dr_train:		0.056
te_valid:		-0.042
te_corr_valid:		3.364
te_dr_valid:		-0.060


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.01it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		9
reg_loss_valid:		0.141
rr_loss_valid:		1.692
reg_acc_valid:		0.855
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.068
l2_loss:		0.000
emb_norm:		16.910
te_train:		-0.015
te_corr_train:		3.443
te_dr_train:		0.037
te_valid:		0.077
te_corr_valid:		3.669
te_dr_valid:		0.080


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		10
reg_loss_valid:		0.110
rr_loss_valid:		19.014
reg_acc_valid:		0.907
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.431
l2_loss:		0.000
emb_norm:		16.937
te_train:		0.093
te_corr_train:		4.981
te_dr_train:		0.062
te_valid:		0.022
te_corr_valid:		5.437
te_dr_valid:		0.293


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.05it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.05it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.05it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.05it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.05it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.05it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.05it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.05it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.05it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.05it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.05it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.05it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.05it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.05it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.05it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.05it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.05it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.05it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.05it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:03,  1.02s/it, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:03,  1.02s/it, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:02,  1.01s/it, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:02,  1.01s/it, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.01it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.01it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.02it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		11
reg_loss_valid:		0.120
rr_loss_valid:		8.442
reg_acc_valid:		0.868
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.312
l2_loss:		0.000
emb_norm:		16.813
te_train:		0.127
te_corr_train:		4.888
te_dr_train:		0.102
te_valid:		0.036
te_corr_valid:		4.453
te_dr_valid:		-0.075


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		12
reg_loss_valid:		0.186
rr_loss_valid:		85.559
reg_acc_valid:		0.779
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.742
l2_loss:		0.000
emb_norm:		16.815
te_train:		0.093
te_corr_train:		7.927
te_dr_train:		0.089
te_valid:		0.090
te_corr_valid:		10.032
te_dr_valid:		1.165


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.05it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.05it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.05it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.05it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		13
reg_loss_valid:		0.175
rr_loss_valid:		62.385
reg_acc_valid:		0.745
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		6.275
l2_loss:		0.000
emb_norm:		16.235
te_train:		0.109
te_corr_train:		7.424
te_dr_train:		0.102
te_valid:		-0.082
te_corr_valid:		7.470
te_dr_valid:		0.642


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.05it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.05it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.05it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.05it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.05it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.05it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.05it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.05it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		14
reg_loss_valid:		0.246
rr_loss_valid:		35.254
reg_acc_valid:		0.740
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.003
l2_loss:		0.000
emb_norm:		15.536
te_train:		0.120
te_corr_train:		4.582
te_dr_train:		0.173
te_valid:		0.237
te_corr_valid:		5.831
te_dr_valid:		-0.299


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.03it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:07,  1.02s/it, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:07,  1.02s/it, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:06,  1.00s/it, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:06,  1.00s/it, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.01it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.01it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.02it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.02it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.02it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.02it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.03it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.03it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.03it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.03it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		15
reg_loss_valid:		0.241
rr_loss_valid:		90.873
reg_acc_valid:		0.688
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.420
l2_loss:		0.000
emb_norm:		17.174
te_train:		0.026
te_corr_train:		6.924
te_dr_train:		0.040
te_valid:		0.239
te_corr_valid:		8.871
te_dr_valid:		-1.040


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.03it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.03it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.03it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		16
reg_loss_valid:		0.206
rr_loss_valid:		19.950
reg_acc_valid:		0.738
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		8.170
l2_loss:		0.000
emb_norm:		16.738
te_train:		0.106
te_corr_train:		6.188
te_dr_train:		0.055
te_valid:		0.080
te_corr_valid:		4.076
te_dr_valid:		-0.621


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.00it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:20,  1.00it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.03it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.03it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.03it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		17
reg_loss_valid:		0.197
rr_loss_valid:		10.788
reg_acc_valid:		0.768
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.606
l2_loss:		0.000
emb_norm:		16.047
te_train:		0.062
te_corr_train:		4.297
te_dr_train:		0.007
te_valid:		0.130
te_corr_valid:		4.000
te_dr_valid:		-0.084


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:0]  5%|▍         | 1/22 [00:01<00:21,  1.01s/it, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.03it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:11,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:10,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		18
reg_loss_valid:		0.186
rr_loss_valid:		14.996
reg_acc_valid:		0.788
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.595
l2_loss:		0.000
emb_norm:		16.404
te_train:		0.138
te_corr_train:		5.111
te_dr_train:		0.137
te_valid:		0.138
te_corr_valid:		3.946
te_dr_valid:		0.117


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/22 [00:00<?, ?it/s]  0%|          | 0/22 [00:00<?, ?it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:0]  5%|▍         | 1/22 [00:00<00:20,  1.01it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:1]  9%|▉         | 2/22 [00:01<00:19,  1.02it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:2] 14%|█▎        | 3/22 [00:02<00:18,  1.03it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:3] 18%|█▊        | 4/22 [00:03<00:17,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:4] 23%|██▎       | 5/22 [00:04<00:16,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:5] 27%|██▋       | 6/22 [00:05<00:15,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:6] 32%|███▏      | 7/22 [00:06<00:14,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:7] 36%|███▋      | 8/22 [00:07<00:13,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:8] 41%|████      | 9/22 [00:08<00:12,  1.04it/s, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:12,  1.03s/it, Batch:22  bidx:9] 45%|████▌     | 10/22 [00:09<00:12,  1.03s/it, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:11,  1.01s/it, Batch:22  bidx:10] 50%|█████     | 11/22 [00:10<00:11,  1.01s/it, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.01it/s, Batch:22  bidx:11] 55%|█████▍    | 12/22 [00:11<00:09,  1.01it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.02it/s, Batch:22  bidx:12] 59%|█████▉    | 13/22 [00:12<00:08,  1.02it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.02it/s, Batch:22  bidx:13] 64%|██████▎   | 14/22 [00:13<00:07,  1.02it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.03it/s, Batch:22  bidx:14] 68%|██████▊   | 15/22 [00:14<00:06,  1.03it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.03it/s, Batch:22  bidx:15] 73%|███████▎  | 16/22 [00:15<00:05,  1.03it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.03it/s, Batch:22  bidx:16] 77%|███████▋  | 17/22 [00:16<00:04,  1.03it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.03it/s, Batch:22  bidx:17] 82%|████████▏ | 18/22 [00:17<00:03,  1.03it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:18] 86%|████████▋ | 19/22 [00:18<00:02,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:19] 91%|█████████ | 20/22 [00:19<00:01,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:20] 95%|█████████▌| 21/22 [00:20<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.04it/s, Batch:22  bidx:21]100%|██████████| 22/22 [00:21<00:00,  1.03it/s, Batch:22  bidx:21]
Validating the cf-dataset
epoch:		19
reg_loss_valid:		0.180
rr_loss_valid:		45.890
reg_acc_valid:		0.801
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.385
l2_loss:		0.000
emb_norm:		17.206
te_train:		0.094
te_corr_train:		6.159
te_dr_train:		0.085
te_valid:		0.072
te_corr_valid:		6.185
te_dr_valid:		-0.036


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(700).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(ambiance)/probe_metric_list.json
2023-03-10 07:52:23.739555: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:52:23.906389: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-03-10 07:52:24.454121: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:52:24.454237: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/tbb/lib/intel64_lin/gcc4.7:/opt/intel/compilers_and_libraries_2018.1.163/linux/compiler/lib/intel64_lin:/opt/intel/compilers_and_libraries_2018.1.163/linux/mkl/lib/intel64_lin::/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64/:/anaconda/envs/tf/lib/
2023-03-10 07:52:24.454254: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
/anaconda/envs/tf/lib/python3.9/site-packages/gensim/similarities/__init__.py:15: UserWarning: The gensim.similarities.levenshtein submodule is disabled, because the optional Levenshtein package <https://pypi.org/project/python-Levenshtein/> is unavailable. Install Levenhstein (e.g. `pip install python-Levenshtein`) to suppress this warning.
  warnings.warn(msg)
/anaconda/envs/tf/lib/python3.9/site-packages/spacy/language.py:1895: UserWarning: [W123] Argument disable with value ['tagger', 'parser', 'lemmatizer', 'ner', 'textcat'] is used instead of ['senter'] as specified in the config. Be aware that this might affect other components in your pipeline.
  warnings.warn(
2023-03-10 07:52:27.533523: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-03-10 07:52:28.044717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13702 MB memory:  -> device: 0, name: Tesla T4, pci bus id: 0001:00:00.0, compute capability: 7.5
Using custom data configuration CEBaB--CEBaB-06a8703c20d64878
Found cached dataset parquet (/home/t-abkumar/.cache/huggingface/datasets/CEBaB___parquet/CEBaB--CEBaB-06a8703c20d64878/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec)
Namespace(expt_name='cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)', run_num=8, num_sample=500, num_topics=1, num_topic_samples=None, l1_lambda=0.0, lr=5e-05, batch_size=32, max_len=80, path='dataset/cebab/', out_path='dataset/cebab', task_name='sentiment', spurious_ratio=None, causal_ratio=None, topic0_corr=None, topic1_corr=None, noise_ratio=0.0, main_topic=None, num_hidden_layer=0, removal_mode=None, main_model_mode='non_causal', head_retrain_mode=None, l2_lambd=0.0, loss_type='x_entropy', dtype='cebab', inv_dims=None, tab_sigma_ubound=None, dropout_rate=0.0, save_emb=False, neg_topic_corr=None, neg1_flip_method=None, measure_flip_pdelta=False, gpu_num=0, valid_before_gupdate=False, add_treatment_on_front=False, concat_word_emb=False, round_gval=False, cfactuals_bsize=1, num_pos_sample=None, num_neg_sample=None, cont_lambda=None, norm_lambda=None, inv_idx=None, closs_type=None, t0_ate=None, t1_ate=None, ate_noise=None, stage_mode='stage1_riesz', teloss_type=None, te_lambda=None, hinge_width=None, num_postalpha_layer=0, rr_lambda=1.0, tmle_lambda=0.0, reg_lambda=1.0, sp_topic_pval=None, return_label_dataset=False, degree_confoundedness=None, cebab_topic_name='noise', topic_pval=inf, separate_cebab_de=False, only_de=False, num_sample_cebab_all=None, topic_name=None, replace_strategy=None, treated_topic=None, adv_rm_epochs=None, rev_grad_strength=None, adv_rm_method=None, stage=None, debug_cidx=None, debug_tidx=0, reverse_grad=False, topic_epochs=None, num_proj_iter=None, hlayer_dim=None, emb_path='glove-wiki-gigaword-100', extend_topic_set=False, vocab_path='assets/word2vec_10000_200d_labels.tsv', num_neigh=None, train_emb=False, normalize_emb=True, temb_dim=None, normalize_temb=False, tfreq_ulim=1.0, transformer='bert-base-uncased', num_epochs=20, load_weight_exp=None, load_weight_epoch=None, gate_weight_exp=None, gate_weight_epoch=None, gate_var_cutoff=None, bert_as_encoder=True, train_bert=True, cached_bemb=False)
Using GPU No: 0
1 Physical GPUs, 1 Logical GPU
Creating log file in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)
Creating the dataset
  0%|          | 0/5 [00:00<?, ?it/s]100%|██████████| 5/5 [00:00<00:00, 651.98it/s]
Some layers from the model checkpoint at bert-base-uncased were not used when initializing TFBertModel: ['nsp___cls', 'mlm___cls']
- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFBertModel were initialized from the model checkpoint at bert-base-uncased.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
Reading the data into dataframe!
Number of examples post first filtering:  11650
Merging the example and their counterfactuals into one!
Avg. number of counterfactual per example: 1.0407124681933841
Number of example pre symmetrizing:  393
Number of example post symmetrizing: 802
Number of Example post merging:  802
positive sentiment ratio:  0.5
Estimated p-value in the current dataset:  0.6
ATE for noise:  -0.04263565891472868
Creating the model
Dumping the config in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/config.json
Initializing the BERT model: bert-base-uncased
Starting the training steps!
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:01<00:18,  1.25s/it, Batch:16  bidx:0]  6%|▋         | 1/16 [00:01<00:18,  1.25s/it, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:02<00:14,  1.07s/it, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:02<00:14,  1.07s/it, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:13,  1.01s/it, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:13,  1.01s/it, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:11,  1.01it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:11,  1.01it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:05<00:10,  1.03it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:05<00:10,  1.03it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:03,  1.01s/it, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:03,  1.01s/it, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.01it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.01it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.02it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.02it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.06it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.03it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		0
reg_loss_valid:		0.109
rr_loss_valid:		-2.364
reg_acc_valid:		0.905
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		0.499
l2_loss:		0.000
emb_norm:		13.888
te_train:		-0.050
te_corr_train:		0.341
te_dr_train:		-0.067
te_valid:		-0.024
te_corr_valid:		1.475
te_dr_valid:		0.000


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.04it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.05it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.05it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.05it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.05it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.08it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		1
reg_loss_valid:		0.185
rr_loss_valid:		-3.989
reg_acc_valid:		0.743
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		4.256
l2_loss:		0.000
emb_norm:		17.048
te_train:		0.214
te_corr_train:		4.267
te_dr_train:		0.135
te_valid:		0.585
te_corr_valid:		3.791
te_dr_valid:		0.207


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.08it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		2
reg_loss_valid:		0.068
rr_loss_valid:		-4.850
reg_acc_valid:		0.933
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.602
l2_loss:		0.000
emb_norm:		16.525
te_train:		-0.194
te_corr_train:		5.012
te_dr_train:		0.073
te_valid:		0.361
te_corr_valid:		5.225
te_dr_valid:		0.229


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.08it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		3
reg_loss_valid:		0.125
rr_loss_valid:		0.878
reg_acc_valid:		0.905
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.323
l2_loss:		0.000
emb_norm:		18.162
te_train:		0.425
te_corr_train:		8.039
te_dr_train:		0.202
te_valid:		0.254
te_corr_valid:		9.130
te_dr_valid:		0.207


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.05it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.05it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.08it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		4
reg_loss_valid:		0.088
rr_loss_valid:		-0.970
reg_acc_valid:		0.886
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		7.496
l2_loss:		0.000
emb_norm:		19.483
te_train:		0.472
te_corr_train:		10.180
te_dr_train:		0.293
te_valid:		0.136
te_corr_valid:		3.868
te_dr_valid:		0.259


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.05it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.05it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.08it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		5
reg_loss_valid:		0.140
rr_loss_valid:		5.275
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		9.327
l2_loss:		0.000
emb_norm:		19.008
te_train:		0.230
te_corr_train:		11.717
te_dr_train:		0.328
te_valid:		-0.105
te_corr_valid:		7.490
te_dr_valid:		0.763


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:01<00:18,  1.23s/it, Batch:16  bidx:0]  6%|▋         | 1/16 [00:01<00:18,  1.23s/it, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:02<00:14,  1.07s/it, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:02<00:14,  1.07s/it, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:13,  1.02s/it, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:13,  1.02s/it, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:11,  1.01it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:11,  1.01it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:05<00:10,  1.02it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:05<00:10,  1.02it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.03it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.03it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.03it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		6
reg_loss_valid:		0.137
rr_loss_valid:		5.399
reg_acc_valid:		0.810
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		2.875
l2_loss:		0.000
emb_norm:		19.708
te_train:		0.107
te_corr_train:		8.085
te_dr_train:		0.217
te_valid:		0.218
te_corr_valid:		7.575
te_dr_valid:		0.186


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.05it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		7
reg_loss_valid:		0.148
rr_loss_valid:		62.016
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.598
l2_loss:		0.000
emb_norm:		18.317
te_train:		0.403
te_corr_train:		15.100
te_dr_train:		0.344
te_valid:		0.323
te_corr_valid:		15.949
te_dr_valid:		-0.971


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		8
reg_loss_valid:		0.122
rr_loss_valid:		-0.051
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		11.023
l2_loss:		0.000
emb_norm:		17.165
te_train:		0.116
te_corr_train:		6.565
te_dr_train:		0.185
te_valid:		0.060
te_corr_valid:		0.824
te_dr_valid:		0.089


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.03it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		9
reg_loss_valid:		0.088
rr_loss_valid:		7.197
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		0.761
l2_loss:		0.000
emb_norm:		17.752
te_train:		0.162
te_corr_train:		4.148
te_dr_train:		0.150
te_valid:		0.282
te_corr_valid:		7.069
te_dr_valid:		0.061


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.04it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		10
reg_loss_valid:		0.141
rr_loss_valid:		41.424
reg_acc_valid:		0.848
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		6.950
l2_loss:		0.000
emb_norm:		17.429
te_train:		0.536
te_corr_train:		15.915
te_dr_train:		0.361
te_valid:		0.360
te_corr_valid:		12.405
te_dr_valid:		-0.391


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:13,  1.03s/it, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:13,  1.03s/it, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:12,  1.01s/it, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:12,  1.01s/it, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.01it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.01it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.02it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.02it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.03it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.03it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.03it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.03it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.04it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		11
reg_loss_valid:		0.128
rr_loss_valid:		72.760
reg_acc_valid:		0.876
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.384
l2_loss:		0.000
emb_norm:		17.769
te_train:		0.557
te_corr_train:		17.584
te_dr_train:		0.549
te_valid:		0.430
te_corr_valid:		15.738
te_dr_valid:		-1.185


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.03it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.05it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		12
reg_loss_valid:		0.145
rr_loss_valid:		94.590
reg_acc_valid:		0.857
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		3.625
l2_loss:		0.000
emb_norm:		17.627
te_train:		0.589
te_corr_train:		20.420
te_dr_train:		0.557
te_valid:		0.414
te_corr_valid:		18.068
te_dr_valid:		-1.071


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.03it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.03it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.03it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.04it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		13
reg_loss_valid:		0.159
rr_loss_valid:		80.833
reg_acc_valid:		0.886
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		2.983
l2_loss:		0.000
emb_norm:		17.638
te_train:		0.602
te_corr_train:		21.292
te_dr_train:		0.641
te_valid:		0.281
te_corr_valid:		15.618
te_dr_valid:		-0.890


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		14
reg_loss_valid:		0.153
rr_loss_valid:		118.166
reg_acc_valid:		0.876
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		1.925
l2_loss:		0.000
emb_norm:		19.440
te_train:		0.580
te_corr_train:		20.433
te_dr_train:		0.585
te_valid:		0.447
te_corr_valid:		18.033
te_dr_valid:		-2.366


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.02it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.03it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.03it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.03it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.03it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.03it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.04it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		15
reg_loss_valid:		0.188
rr_loss_valid:		164.016
reg_acc_valid:		0.857
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		2.442
l2_loss:		0.000
emb_norm:		18.718
te_train:		0.584
te_corr_train:		23.012
te_dr_train:		0.582
te_valid:		0.484
te_corr_valid:		23.384
te_dr_valid:		-2.083


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:06,  1.03s/it, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:06,  1.03s/it, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:05,  1.01s/it, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:05,  1.01s/it, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.01it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.01it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.02it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.02it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.03it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.03it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.03it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.03it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.06it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.03it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		16
reg_loss_valid:		0.108
rr_loss_valid:		25.596
reg_acc_valid:		0.895
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		14.934
l2_loss:		0.000
emb_norm:		19.478
te_train:		0.437
te_corr_train:		19.714
te_dr_train:		0.440
te_valid:		0.197
te_corr_valid:		9.130
te_dr_valid:		-0.563


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.01it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.05it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		17
reg_loss_valid:		0.174
rr_loss_valid:		136.729
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		2.657
l2_loss:		0.000
emb_norm:		19.035
te_train:		0.558
te_corr_train:		19.709
te_dr_train:		0.512
te_valid:		0.326
te_corr_valid:		18.476
te_dr_valid:		-1.205


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:00<00:14,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.04it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:03<00:12,  1.04it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:12,  1.03s/it, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:04<00:12,  1.03s/it, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:11,  1.00s/it, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:11,  1.00s/it, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.01it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.01it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.02it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.02it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.03it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.03it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.03it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.03it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.03it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.03it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.03it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.03it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.03it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.03it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.03it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		18
reg_loss_valid:		0.195
rr_loss_valid:		32.920
reg_acc_valid:		0.771
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		5.112
l2_loss:		0.000
emb_norm:		19.950
te_train:		0.295
te_corr_train:		15.681
te_dr_train:		0.343
te_valid:		0.378
te_corr_valid:		12.485
te_dr_valid:		-1.519


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
==========================================
Training the Stage1 with: 	stage1_riesz
  0%|          | 0/16 [00:00<?, ?it/s]  0%|          | 0/16 [00:00<?, ?it/s, Batch:16  bidx:0]  6%|▋         | 1/16 [00:01<00:15,  1.00s/it, Batch:16  bidx:0]  6%|▋         | 1/16 [00:01<00:15,  1.00s/it, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.02it/s, Batch:16  bidx:1] 12%|█▎        | 2/16 [00:01<00:13,  1.02it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.03it/s, Batch:16  bidx:2] 19%|█▉        | 3/16 [00:02<00:12,  1.03it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.03it/s, Batch:16  bidx:3] 25%|██▌       | 4/16 [00:03<00:11,  1.03it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:4] 31%|███▏      | 5/16 [00:04<00:10,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:5] 38%|███▊      | 6/16 [00:05<00:09,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:6] 44%|████▍     | 7/16 [00:06<00:08,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:7] 50%|█████     | 8/16 [00:07<00:07,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:8] 56%|█████▋    | 9/16 [00:08<00:06,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:9] 62%|██████▎   | 10/16 [00:09<00:05,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:10] 69%|██████▉   | 11/16 [00:10<00:04,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:11] 75%|███████▌  | 12/16 [00:11<00:03,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:12] 81%|████████▏ | 13/16 [00:12<00:02,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:13] 88%|████████▊ | 14/16 [00:13<00:01,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:14] 94%|█████████▍| 15/16 [00:14<00:00,  1.04it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.07it/s, Batch:16  bidx:15]100%|██████████| 16/16 [00:15<00:00,  1.04it/s, Batch:16  bidx:15]
Validating the cf-dataset
epoch:		19
reg_loss_valid:		0.207
rr_loss_valid:		145.490
reg_acc_valid:		0.867
reg_loss_all_valid:		0.000
reg_acc_all_valid:		0.000
rr_loss_all_valid:		0.000
tmle_loss:		2.815
l2_loss:		0.000
emb_norm:		18.778
te_train:		0.541
te_corr_train:		20.640
te_dr_train:		0.445
te_valid:		0.354
te_corr_valid:		19.761
te_dr_valid:		-2.271


alpha for each subgroup:
alpha:t00-tcf0 = 0.0
alpha:t00-tcf1 = 0.0
alpha:t01-tcf0 = 0.0
alpha:t01-tcf1 = 0.0
Classifier Accuracy:
Dumping the probe metrics in: dataset/cebab/nlp_logs/cad.cebabs1riesz.rnum(8).sample(500).hlayer(0).pval(inf).dtidx(0).rr_lmd(1).reg_lmd(1).tmle_lmd(0).l2_lmd(0.0).dcf().noise(0.0).topic(noise)/probe_metric_list.json
